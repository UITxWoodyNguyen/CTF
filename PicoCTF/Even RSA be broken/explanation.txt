Mục đích chung

Script tìm thừa số p, q của N bằng Pollard‑Rho, tính d = e^{-1} (mod φ(N)), rồi giải mã m = c^d mod N và chuyển integer m về bytes/text.
is_probable_prime(n)

Kiểm tra chia hết bởi vài số nguyên tố nhỏ trước.
Thực hiện kiểm tra Miller–Rabin (số lần lặp mặc định) để xác suất chắc chắn rằng n là nguyên tố.
pollards_rho(n) và factor(n)

pollards_rho dùng thuật toán Pollard’s Rho với đa thức x^2 + c để tìm 1 ước không tầm thường.
factor là đệ quy: nếu n là nguyên tố trả về [n], nếu không tách theo factor(n) và factor(n//d).
egcd(a, b) và modinv(a, m)

egcd trả về (g, x, y) sao cho ax + by = g = gcd(a,b).
modinv dùng egcd để tính nghịch đảo modular; nếu gcd ≠ 1 thì không tồn tại nghịch đảo.
int_to_bytes(i)

Chuyển integer sang bytes theo định dạng big-endian với độ dài tối thiểu cần thiết.
Các bước RSA và giải mã

Sau khi có p, q: phi = (p-1)*(q-1).
d = modinv(e, phi).
m = pow(c, d, N) để lấy lại số nguyên plaintext.
Chuyển m về bytes và decode UTF-8 (nếu được).
