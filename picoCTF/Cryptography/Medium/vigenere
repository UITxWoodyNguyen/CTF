Vigenère

Information
Category: Cryptography
Point:
Level: Medium
Description:
Can you decrypt this message? Decrypt this message using this key "CYLAB".
cipher:
rgnoDVD{O0NU_WQ3_G1G3O3T3_A1AH3S_cc82272b}

Solution
Giải thích mã hóa:
Hàm vigenereDecrypt 

Ciphertext và key đều gồm các ký tự chữ cái (A–Z hoặc a–z), và thuật toán sử dụng cơ chế của Vigenère cipher.

Với mỗi ký tự trong ciphertext:
 	-Ta xác định biến base là 'A' nếu ký tự là chữ hoa hoặc 'a' nếu là chữ thường.

 	-Việc này giúp đưa ký tự về khoảng giá trị 0–25 mà vẫn giữ nguyên kiểu chữ khi chuyển ngược lại.

Sau đó ta xét từng ký tự của ciphertext tương ứng với từng ký tự của key:

 	-Nếu độ dài ciphertext lớn hơn key, ta sử dụng i % key.length() để lặp lại key tuần hoàn.

 	-Mỗi ký tự key được chuyển về chữ thường (nếu cần) để chuẩn hóa.

 	-Ta tính giá trị dịch bằng:
 				shift = key_char - 'a'
 	khi đó :a->0 ,b->1,...,z->25
Cuối cùng, ta áp dụng công thức giải mã của Vigenère:

** 				P=(C−K)mod26**

đây là code:

def vigenere_decrypt(cipher, key):
    result = ""
    key_index = 0

    for c in cipher:
        if c.isalpha():   # giống isalpha()
            base = 'A' if c.isupper() else 'a'
            shift = ord(key[key_index % len(key)].lower()) - ord('a')
            decrypted = chr((ord(c) - ord(base) - shift + 26) % 26 + ord(base))
            result += decrypted
            key_index += 1
        else:
            result += c

    return result
cipher ="rgnoDVD{O0NU_WQ3_G1G3O3T3_A1AH3S_cc82272b}"
key="CYLAB"
print(vigenere(cipher,key))


Trước tiên, chương trình kiểm tra ký tự hiện tại (c) là chữ hoa hay chữ thường để xác định mốc ASCII phù hợp ('A' hoặc 'a'). Việc này giúp chuyển ký tự về khoảng giá trị từ 0 đến 25 mà vẫn giữ nguyên kiểu chữ khi chuyển ngược lại.

Tiếp theo, chương trình lấy ký tự tương ứng trong key. Vì key có thể ngắn hơn ciphertext nên dùng i % key.length() để lặp lại key theo chu kỳ. Ký tự key được chuyển về chữ thường và trừ 'a' để lấy giá trị dịch (shift) từ 0 đến 25.

Cuối cùng, công thức:
 		((c−base−shift+26)%26)+base

flag:	picoCTF{D0NT_US3_V1G3N3R3_C1PH3R_ae82272q}
